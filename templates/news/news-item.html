{% extends "layout/template-base.html" %}

{% block title %}MSX Center - News{% endblock %}

{% block extracss %}
    <link rel="stylesheet" href="/static/css/news.css">
{% endblock %}

{% macro news_item_comment(comment) %}
<div class="news-item-comment">
    <div class="metadata">
	    <img src="{{ comment.user.profile_photo_url(size='small') }}" alt="{{ comment.user.real_name }}'s profile photo">
        <div>
            <div>
                <p class="comment-author"><a href="{{ url_for('page_member', member_id=comment.user.id, slug=comment.user.slug) }}"><strong>{{ comment.user.real_name }}</strong></a></p>
                <p class="comment-date">Posted on {{ comment.date_posted.strftime('%b %-d, %Y') }}</p>
            </div>
        </div>
    </div>
    <div class="comment-body">{{ comment.body_en }}</div>
</div>
{% endmacro %}

{% macro news_sidebar_most_popular() %}
<h4 class="news-section-divider">Most popular</h4>
<p class="text-muted">The most visited news items of the last 90 days;</p>
<ol>
	<li><a href="#">Something happened in that user meeting</a></li>
	<li><a href="#">The French fries in this Burger King are too salty</a></li>
	<li><a href="#">The French fries in this Burger King are too salty</a></li>
	<li><a href="#">The French fries in this Burger King are too salty</a></li>
	<li><a href="#">Nintendo won't release more games for MSX computers</a></li>
	<li><a href="#">Tecnobytes releases new FC SAN interface cartridge</a></li>
	<li><a href="#">Tecnobytes releases new FC SAN interface cartridge</a></li>
	<li><a href="#">Tecnobytes releases new FC SAN interface cartridge</a></li>
	<li><a href="#">The msx.org web server found dead under a bridge (again)</a></li>
	<li><a href="#">The msx.org web server found dead under a bridge (again)</a></li>
</ol>
{% endmacro %}

{% macro news_item_related_link(link) %}
<dt><a href="{{ url_for('visit_link', link_id=link.id) }}"><span class="fa fa-external-link"></span> {{ link.title }}</a></dt>
<dd>{{ link.desc_en }}</dd>
{% endmacro %}

{% macro news_sidebar_sponsor() %}
<h4 class="news-section-divider">Sponsor</h4>
<div class="text-center"><img src="/static/img/Ads/googleads-200x200.png"></div>
{% endmacro %}

{% macro news_sidebar_archive() %}
<h4 class="news-section-divider">News archive </h4>
<ul>
	<li><a href="#">March 2017 (12 items)</a></li>
	<li><a href="#">February 2017 (8 items)</a></li>
	<li><a href="#">January 2017 (1 item)</a></li>
	<li><a href="#">December 2016 (15 items)</a></li>
</ul>
{% endmacro %}

{% block content %}
<div class="row">
    <div class="col-lg-9 col-md-9 col-sm-12 col-xs-12">
        <div class="row">
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 news-item-column">
                <div id="news-item-full">
                    <h5 class="text-uppercase">{{ news_item.category.name_en }}</h5>

                    {# HEADLINES #}
                    <h2>{{ news_item.headline_en }}</h2>
                    {% if news_item.subhead_en %}
	                    <h3>{{ news_item.subhead_en }}</h3>
                    {% endif %}

                    {# METADATA (Author and date) #}
                    <div id="news-item-metadata">
	                    <img src="{{ news_item.author.profile_photo_url(size='small') }}" alt="{{ news_item.author.real_name }}'s profile photo">
                        <div>
                            <p class="news-author-name"><a href="#"><strong>{{ news_item.author.real_name }}</strong></a> </p>
                            <p class="news-item-date">Posted on {{ news_item.date_published.strftime('%b %-d, %Y') }}</p>
                        </div>
                    </div>

                    {# HEADER IMAGE AND CAPTION #}
                    <div id="header-image">
	                    <img src="{{ url_for('send_image', image_id=news_item.header_image_id, dummy_filename='header_image') }}" class="img-responsive">
                        {% if news_item.header_image_caption %}
                        	<p>{{ news_item.header_image_caption }}</p>
                    	{% endif %}
                    </div>

                    {# NEWS ITEM BODY #}
                    <div id="news-item-body" class="text-justify">
	                    {{ news_item.body_en }}
                    </div>
                    
                    {# RELATED LINKS #}
                    {% if news_item.related_links %}
	                    <div id="news-item-links">
	                        <h4 class="news-section-divider">Related links</h4>
	                        <dl class="related-links">
		                        {% for link in news_item.related_links %}
		                        	{{ news_item_related_link(link) }}
		                        {% endfor %}
							</dl>
	                    </div>
                    {% endif %}

                    {# COMMENTS #}
                    <div id="news-item-comments">
                        <h4 class="news-section-divider">Comments</h4>
                        {% if news_item.comments %}
                        	{% for comment in news_item.comments %}
                        		{{ news_item_comment(comment) }}
                        	{% endfor %}
                        {% else %}
                        	<div class="alert alert-warning">
	                        	There are no comments yet.
                        	</div>
                        {% endif %}
                        <hr>
                        <div id="post-comment-form">
	                        {% if user %}
	                            <form id="form_news_item_post_comment">
	                                <div class="form-group">
	                                    <p class="help-block">Post a reply below.</p>
										<div class="form-control" id="quillEditor"></div>
	                                </div>
	                                <div class="form-group">
	                                    <button id="submit_button" class="btn btn-primary btn-xs" type="submit">Post comment</button>
	                                    <button id="reset_button" class="btn btn-default btn-xs" type="reset">Cancel</button>
	                                </div>
	                            </form>
                            {% else %}
                            	<div class="alert alert-warning">
	                            	You need to be <a class="alert-link" href="{{ url_for('page_signin') }}"><b>signed in</a> to comment.
                            	</div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12">
		{{ news_sidebar_most_popular() }}
		{{ news_sidebar_archive() }}
    </div>
</div>
{% endblock %}